(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     58792,       1545]
NotebookOptionsPosition[     57421,       1496]
NotebookOutlinePosition[     57797,       1512]
CellTagsIndexPosition[     57754,       1509]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Automatically", " ", "generate", " ", "package", " ", "from", " ", 
    "initializtion", " ", "cells", " ", "of", " ", "the", " ", "current", " ",
     "notebook"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"InputNotebook", "[", "]"}], ",", 
    RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.663777636459733*^9, 3.663777712128561*^9}, {
  3.733914406837203*^9, 3.7339144075478926`*^9}, {3.733914733952835*^9, 
  3.7339147356576366`*^9}},
 CellID->484687852],

Cell[CellGroupData[{

Cell["Patterns and test functions", "Section",
 CellChangeTimes->{{3.7339903638501253`*^9, 3.7339903741973023`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FunctionQ", "::", "usage"}], "=", 
   "\"\<FunctionQ[expr_] tests if expression is a Function, CompiledFunction \
or InterpolatingFunction.\>\""}], "\n", "\t", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Adopted", " ", "from", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stackoverflow", ".", "com"}], "/", "questions"}], "/", 
       "3736942"}], "/", "test"}], "-", "if", "-", "an", "-", "expression", 
     "-", "is", "-", "a", "-", "function"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"FunctionQ", "[", 
   RowBox[{
   "_Function", "|", "_InterpolatingFunction", "|", "_CompiledFunction"}], 
   "]"}], "=", "True"}], "\n", 
 RowBox[{
  RowBox[{"FunctionQ", "[", "f_Symbol", "]"}], ":=", 
  RowBox[{"Or", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DownValues", "[", "f", "]"}], "=!=", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"Attributes", "[", "f", "]"}], ",", "NumericFunction"}], 
     "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"FunctionQ", "[", "_", "]"}], "=", "False"}]}], "Code",
 CellChangeTimes->{{3.7339904263153253`*^9, 3.7339905700259266`*^9}, {
  3.7339906088478365`*^9, 3.733990611067322*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Tests", " ", "if", " ", "the", " ", "argument", " ", "is", " ", "a", " ", 
    "vector", " ", "or", " ", "array", " ", "of", " ", "numbers"}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"NumericVectorQ", "[", "expr_", "]"}], ":=", 
    RowBox[{"VectorQ", "[", 
     RowBox[{"expr", ",", "NumericQ"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"NumericArrayQ", "[", "expr_", "]"}], ":=", 
    RowBox[{"ArrayQ", "[", 
     RowBox[{"expr", ",", "_", ",", "NumericQ"}], "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.733990657086379*^9, 3.7339906583800373`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"notOptPatt", "::", "usage"}], "=", 
   "\"\<Except[_?OptionQ]\n\tA pattern to test if the expression is NOT an \
option. \n\tTypical usage is to define optional arguments in functions, which \
at the same time can accept options. \n\nExample:\n\tDefinition of function \
with an optional argument y having the default value of 1 and at the same \
time an option Option1 with default value 2\t\n\tf[x_, y:notOptPatt:1, \
OptionsPattern[{Option1->2}]]:=\!\(\*SuperscriptBox[\(x\), \
\(2\)]\)+y+OptionValue[Option1]\>\""}], "\n"}], "\n", 
 RowBox[{"notOptPatt", "=", 
  RowBox[{"Except", "[", 
   RowBox[{"_", "?", "OptionQ"}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.733990667517043*^9, 3.7339906856915627`*^9}, {
   3.7339907410041885`*^9, 3.7339909168407345`*^9}, {3.7339909586262817`*^9, 
   3.7339910228491125`*^9}, {3.7339910647788143`*^9, 3.73399113653504*^9}, {
   3.7339944451158495`*^9, 3.7339944456510053`*^9}, 3.7339948728148193`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "differentiate", " ", "between", " ", "2", "D", " ", "and", " ", "3", "D", 
    " ", "datasets"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"XYListQ", "::", "usage"}], "=", 
    "\"\<XYListQ[list_], XYListQ[list_,d_]\n\tTest if list is a xylist of \
dimension d, d=1 if omitted.\>\""}], "\n", "\t", "\n", 
   RowBox[{
    RowBox[{"XYListQ", "[", "list_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ArrayQ", "[", 
      RowBox[{"list", ",", "2"}], "]"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "list", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "2"}], ")"}]}]}], "\n", 
   RowBox[{
    RowBox[{"XYListQ", "[", 
     RowBox[{"list_", ",", "d_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ListQ", "[", "list", "]"}], "&&", " ", 
     RowBox[{"AllTrue", "[", 
      RowBox[{"list", ",", "XYListQ", ",", 
       RowBox[{"d", "-", "1"}]}], "]"}]}]}]}]}]], "Code",
 CellChangeTimes->{
  3.733991245908392*^9, {3.733991349818822*^9, 3.733991436748381*^9}, {
   3.7339944748207164`*^9, 3.733994563490768*^9}, 3.7339946265227027`*^9, {
   3.7339947286188965`*^9, 3.7339947307454023`*^9}, {3.7339949139841447`*^9, 
   3.733994922983019*^9}, {3.7339951583685727`*^9, 3.7339951585280437`*^9}, {
   3.733995242549082*^9, 3.733995324444669*^9}, {3.7339956822302866`*^9, 
   3.7339957009205127`*^9}, {3.733995807619132*^9, 3.7339958327256675`*^9}, 
   3.7339966852784204`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"XYZListQ", "::", "usage"}], "=", 
   "\"\<XYZListQ[list_], XYZListQ[list_,d_]\n\tTest if list is and xyzlist of \
the dimension d, d=1 if omitted.\>\""}], "\n", "\t"}], "\n", 
 RowBox[{
  RowBox[{"XYZListQ", "[", "list_", "]"}], ":=", 
  RowBox[{
   RowBox[{"ArrayQ", "[", 
    RowBox[{"list", ",", "2"}], "]"}], "&&", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Dimensions", "[", "list", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "==", "3"}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{"XYZListQ", "[", 
   RowBox[{"list_", ",", "d_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ListQ", "[", "list", "]"}], "&&", " ", 
   RowBox[{"AllTrue", "[", 
    RowBox[{"list", ",", "XYZListQ", ",", 
     RowBox[{"d", "-", "1"}]}], "]"}]}]}]}], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.733995736898099*^9, 3.7339957475509605`*^9}, {
   3.7339957784190626`*^9, 3.7339957861832943`*^9}, 3.7339958564219456`*^9, 
   3.7339966865387115`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Manipulations with xy- and xyz- lists", "Section",
 CellChangeTimes->{{3.7339959576736984`*^9, 3.7339959724799905`*^9}}],

Cell[CellGroupData[{

Cell["Mapping over specific dimension", "Subsection",
 CellChangeTimes->{{3.733998804516633*^9, 3.7339988140165777`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Useful", " ", "functions", " ", "adopted", " ", "with", " ", "slight", 
     " ", "extension", " ", "from", " ", "the", " ", 
     RowBox[{"V", ".", 
      RowBox[{"Sudhir", "'"}]}], "s", " ", "He3Analysis", " ", "package"}], 
    ";", "\n", 
    RowBox[{
     RowBox[{"The", " ", "function", " ", "names", " ", "are", " ", "self"}], 
     "-", "explanatory"}]}], ",", " ", 
   RowBox[{
   "the", " ", "two", " ", "instances", " ", "are", " ", "different", " ", 
    "in", " ", "the", " ", "argument", " ", 
    RowBox[{"type", "."}]}]}], "*)"}]], "Code"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapX", "::", "usage"}], "=", 
  "\"\<MapX[f_,list_] applies function f to X elements in xy- or xyz- \
list\>\""}], "\n", 
 RowBox[{
  RowBox[{"MapX", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"list_", "?", "XYListQ"}]}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", "list"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MapX", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"list_", "?", "XYZListQ"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], ",", "list"}], 
    "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"MapY", "::", "usage"}], "=", 
  "\"\<MapY[f_,list_] applies function f to Y elements in xy- or xyz- \
list\>\""}], "\n", 
 RowBox[{
  RowBox[{"MapY", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"list_", "?", "XYListQ"}]}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", "list"}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MapY", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"list_", "?", "XYZListQ"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"f", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", "list"}], 
    "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"MapXY", "::", "usage"}], "=", 
  "\"\<MapX[fx_,fy_,list_] applies functions fx and fy correspondingly to X \
and Y elements in xy- or xyz- list\>\""}], "\n", 
 RowBox[{
  RowBox[{"MapXY", "[", 
   RowBox[{"fx_", ",", "fy_", ",", 
    RowBox[{"list_", "?", "XYListQ"}]}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fx", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"fy", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", "list"}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MapXY", "[", 
    RowBox[{"fx_", ",", "fy_", ",", 
     RowBox[{"list_", "?", "XYZListQ"}]}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"fy", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], ",", "list"}], 
    "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"MapZ", "::", "usage"}], "=", 
  "\"\<MapZ[f_,list_] applies function f to Z elements in xyzlist\>\""}], "\n\
", 
 RowBox[{
  RowBox[{"MapZ", "[", 
   RowBox[{"f_", ",", "xyzlist_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
    "xyzlist"}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.733995983435758*^9, 3.733996047818942*^9}, {
  3.7339960862113943`*^9, 3.733996313181395*^9}, {3.733996700815343*^9, 
  3.7339967284947357`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rescaling xylist along x and y axes ", "Subsection",
 CellChangeTimes->{{3.733997106814396*^9, 3.733997136773698*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScaleY", "::", "usage"}], "=", 
   "\"\<ScaleX[list_,a_], ScaleY[list_,a_], ShiftX[list_,a_], \
ShiftY[list_,a_]\n\trescale or offset data along the x and y coordinates by \
the amount a_\n\tEach of the function names can be used as an option in \
another. E.g. simultaneus shift along x axis by a and rescaling along \n\ty \
by b can be equivalently written as ScaleY[list,b,ShiftX\[Rule]a] or \
ShiftX[list,b,ScaleY\[Rule]a].\n\nInput:\n\tlist_ is either xylist or \
xylistd2. a is a constant if list_ is xylist or if list_ is xylistd2, can be \
a vector of constants\n\tfor each element in xylistd2. Specifically for \
ShiftY, a_ can be a xylist or a list of xylists, in which case the y-values \n\
\tof this xylist are added to the y- values of list_.\n\nOutput: \n\t\
{{x,y},...}\[Rule]{{ScaleX\[Times](x+ShiftX),ScaleY\[Times](y+ShiftY)},...}\>\
\""}], "\n", "\t"}], "\n", 
 RowBox[{
  RowBox[{"ScaleX", "::", "usage"}], "=", 
  RowBox[{"ScaleY", "::", "usage"}]}], "\n", 
 RowBox[{
  RowBox[{"ShiftY", "::", "usage"}], "=", 
  RowBox[{"ScaleY", "::", "usage"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ShiftX", "::", "usage"}], "=", 
   RowBox[{"ScaleY", "::", "usage"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SSXY", "::", "usage"}], "=", 
    "\"\<SSXY[list_,xSc_,ySc_,xSh_,ySh_] low level generic rescaling function \
used by ScaleY, ScaleX, ShiftY and ShiftX\>\""}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"Versions", " ", "for", " ", "various", " ", "inputs"}], "*)"}], 
  "\t\t\t\t"}], "\n", 
 RowBox[{
  RowBox[{"SSXY", "[", 
   RowBox[{
    RowBox[{"xylist_", "?", "XYListQ"}], ",", "xSc_", ",", "ySc_", ",", 
    "xSh_", ",", "ySh_"}], "]"}], ":=", 
  RowBox[{"Which", "[", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"XYListQ", "[", "ySh", "]"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "[", "ySh", "]"}], "==", 
       RowBox[{"Length", "[", "xylist", "]"}]}], ")"}]}], ",", "\n", "\t\t", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xSc", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xylist", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "1"}], "]"}], "]"}], "+", "xSh"}], ")"}]}], 
       ",", 
       RowBox[{"ySc", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xylist", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"ySh", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
     ",", "\n", "\t", "True", ",", "\n", "\t\t", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xSc", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xylist", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "1"}], "]"}], "]"}], "+", "xSh"}], ")"}]}], 
       ",", 
       RowBox[{"ySc", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xylist", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}], "+", "ySh"}], ")"}]}]}], 
      "}"}], "]"}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SSXY", "[", 
    RowBox[{
     RowBox[{"list_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XYListQ", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}], ")"}]}], ",", "xSc_", ",", 
     "ySc_", ",", "xSh_", ",", "ySh_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xScListQ", ",", "yScListQ", ",", "xShListQ", ",", "yShListQ", ",", 
       "xScTmp", ",", "yScTmp", ",", "xShTmp", ",", "yShTmp"}], "}"}], ",", 
     "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
      "Check", " ", "if", " ", "need", " ", "to", " ", "iterate", " ", "over",
        " ", "the", " ", "variables"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"xScListQ", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"VectorQ", "[", "xSc", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "xSc", "]"}], "\[Equal]", 
           RowBox[{"Length", "[", "list", "]"}]}], ")"}]}], ")"}]}], ";", 
      "\n", "\t", 
      RowBox[{"yScListQ", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"VectorQ", "[", "ySc", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "ySc", "]"}], "\[Equal]", 
           RowBox[{"Length", "[", "list", "]"}]}], ")"}]}], ")"}]}], ";", 
      "\n", "\t", 
      RowBox[{"xShListQ", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"VectorQ", "[", "xSh", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "xSh", "]"}], "\[Equal]", 
           RowBox[{"Length", "[", "list", "]"}]}], ")"}]}], ")"}]}], ";", 
      "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "case", " ", "of", " ", "shift", " ", "in", " ", "y", " ", 
        "direction", " ", "is", " ", "special", " ", "as", " ", "here", " ", 
        "multiple", " ", "xylists", " ", "can", " ", "be", " ", "supplied"}], 
       "*)"}], "\n", "\t", 
      RowBox[{"yShListQ", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"VectorQ", "[", "ySh", "]"}], "||", 
           RowBox[{"XYListQ", "[", 
            RowBox[{"ySh", ",", "2"}], "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "ySh", "]"}], "\[Equal]", 
           RowBox[{"Length", "[", "list", "]"}]}], ")"}]}], ")"}]}], ";", 
      "\t", "\n", "\t", 
      RowBox[{"Table", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"xScTmp", "=", 
          RowBox[{"If", "[", 
           RowBox[{"xScListQ", ",", " ", 
            RowBox[{"xSc", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "xSc"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"yScTmp", "=", 
          RowBox[{"If", "[", 
           RowBox[{"yScListQ", ",", " ", 
            RowBox[{"ySc", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "ySc"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"xShTmp", "=", 
          RowBox[{"If", "[", 
           RowBox[{"xShListQ", ",", " ", 
            RowBox[{"xSh", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "xSh"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"yShTmp", "=", 
          RowBox[{"If", "[", 
           RowBox[{"yShListQ", ",", " ", 
            RowBox[{"ySh", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "ySh"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"SSXY", "[", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "xScTmp", ",", "yScTmp", ",",
            "xShTmp", ",", "yShTmp"}], "]"}]}], "\n", "\t\t", ",", "\n", 
        "\t\t", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "\n", "\t", "]"}], 
      ";", "\n", "\t", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "a", "]"}], ",", "\n", "\t\t", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ScaleY", "[", 
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"a", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "opts"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ",", "\n",
         "\t\t", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SSXY", "[", 
           RowBox[{"xylist", ",", "xSc", ",", "ySc", ",", "xSh", ",", "ySh"}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"xylist", ",", "list"}], "}"}]}], "]"}]}], "\n", "\t", 
       "]"}]}]}], "\n", "]"}]}], "\n", "\t\t"}], "\n", 
 RowBox[{
  RowBox[{"ScaleY", "[", 
   RowBox[{"list_", ",", " ", 
    RowBox[{"a", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "1"}], ",", " ", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ScaleX", "->", "1"}], ",", 
       RowBox[{"ShiftX", "->", "0"}], ",", 
       RowBox[{"ShiftY", "->", "0"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xSc", ",", "ySc", ",", "xSh", ",", "ySh"}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"xSc", "=", 
      RowBox[{"OptionValue", "[", "ScaleX", "]"}]}], ";", "\n", "\t", 
     RowBox[{"ySc", "=", "a"}], ";", "\n", "\t", 
     RowBox[{"xSh", "=", 
      RowBox[{"OptionValue", "[", "ShiftX", "]"}]}], ";", "\n", "\t", 
     RowBox[{"ySh", "=", 
      RowBox[{"OptionValue", "[", "ShiftY", "]"}]}], ";", "\t", "\n", "\t", 
     RowBox[{"SSXY", "[", 
      RowBox[{"list", ",", "xSc", ",", "ySc", ",", "xSh", ",", "ySh"}], 
      "]"}]}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ScaleX", "[", 
   RowBox[{"list_", ",", " ", 
    RowBox[{"a", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "1"}], ",", " ", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ScaleY", "->", "1"}], ",", 
       RowBox[{"ShiftX", "->", "0"}], ",", 
       RowBox[{"ShiftY", "->", "0"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xSc", ",", "ySc", ",", "xSh", ",", "ySh"}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"xSc", "=", "a"}], ";", "\n", "\t", 
     RowBox[{"ySc", "=", 
      RowBox[{"OptionValue", "[", "ScaleY", "]"}]}], ";", "\n", "\t", 
     RowBox[{"xSh", "=", 
      RowBox[{"OptionValue", "[", "ShiftX", "]"}]}], ";", "\n", "\t", 
     RowBox[{"ySh", "=", 
      RowBox[{"OptionValue", "[", "ShiftY", "]"}]}], ";", "\t", "\n", "\t", 
     RowBox[{"SSXY", "[", 
      RowBox[{"list", ",", "xSc", ",", "ySc", ",", "xSh", ",", "ySh"}], 
      "]"}]}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ShiftY", "[", 
   RowBox[{"list_", ",", " ", 
    RowBox[{"a", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "0"}], ",", " ", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ScaleX", "->", "1"}], ",", 
       RowBox[{"ScaleY", "->", "1"}], ",", 
       RowBox[{"ShiftX", "->", "0"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xSc", ",", "ySc", ",", "xSh", ",", "ySh"}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"xSc", "=", 
      RowBox[{"OptionValue", "[", "ScaleX", "]"}]}], ";", "\n", "\t", 
     RowBox[{"ySc", "=", 
      RowBox[{"OptionValue", "[", "ScaleY", "]"}]}], ";", "\n", "\t", 
     RowBox[{"xSh", "=", 
      RowBox[{"OptionValue", "[", "ShiftX", "]"}]}], ";", "\n", "\t", 
     RowBox[{"ySh", "=", "a"}], ";", "\t", "\n", "\t", 
     RowBox[{"SSXY", "[", 
      RowBox[{"list", ",", "xSc", ",", "ySc", ",", "xSh", ",", "ySh"}], 
      "]"}]}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ShiftX", "[", 
   RowBox[{
    RowBox[{"list_", "?", "XYListQ"}], ",", " ", 
    RowBox[{"a", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "0"}], ",", " ", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ScaleX", "->", "1"}], ",", 
       RowBox[{"ScaleY", "\[Rule]", "1"}], ",", 
       RowBox[{"ShiftY", "->", "0"}]}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xSc", ",", "ySc", ",", "xSh", ",", "ySh"}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"xSc", "=", 
      RowBox[{"OptionValue", "[", "ScaleX", "]"}]}], ";", "\n", "\t", 
     RowBox[{"ySc", "=", 
      RowBox[{"OptionValue", "[", "ScaleY", "]"}]}], ";", "\n", "\t", 
     RowBox[{"xSh", "=", "a"}], ";", "\n", "\t", 
     RowBox[{"ySh", "=", 
      RowBox[{"OptionValue", "[", "ShiftY", "]"}]}], ";", "\t", "\n", "\t", 
     RowBox[{"SSXY", "[", 
      RowBox[{"list", ",", "xSc", ",", "ySc", ",", "xSh", ",", "ySh"}], 
      "]"}]}]}], "\n", "]"}]}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJwdzV0oQwEABeDbeGC72zIbotTaLOT3RWprrLW0JjJTS0hrGw/KCJkahbTZ
npQsoyX5iZKQmPwUW6RGtCwexJK08SCTpOWe+3D6Hk6nIzR0a00MgiByqcBA
UiKYchNVMO2aMKx7EH3CXpErDnW2tqRUSvk1Lwsy3WwhJOvTaFUzAQVs3CeU
8FS5rIbVJp0eSgw3Jhh7fLbCkhrpGMxwPdL+TP9McCh/ZRYH5BV1BbmUk60j
YdhZIFCwbqMKvl+sgs51jR32qqYc8ExNeiCxfeWFnSGWgKQU97/nwL2PSiFc
SM8rh6vGBi3dH0sbIb/ishnm18Za4HnPoQHe+y864HD2hAWSicJBePJ2NArN
IzIPDDP3vPRuM7IIffqVNTjOtmxA7cDsDjQm3+/Sf3dNB7B0S/wEd8tCL7Bv
df4VfsvIGPQybLRfQ1V/0J2pppXEiwk25dqcngudbr8ctvkiZuhrJ6yQM9yw
BP8B2RntFg==
  "]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Manipulations with intervals", "Section",
 CellChangeTimes->{{3.733996468389759*^9, 3.733996474081539*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"From", " ", 
    RowBox[{"http", ":"}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
       "questions"}], "/", "11345"}], "/", "can"}], "-", "mathematica", "-", 
    "handle", "-", "open", "-", "intervals", "-", "interval", "-", 
    "complements"}]}], "*)"}]], "Code",
 CellChangeTimes->{3.733996525714651*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IntervalInverse", "::", "usage"}], "=", 
   "\"\<IntervalInverse[a_] returns complement (\[Minus]\[Infinity],\
\[Infinity])/a\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"IntervalInverse", "[", 
   RowBox[{"Interval", "[", "int___", "]"}], "]"}], ":=", 
  RowBox[{"Interval", "@@", 
   RowBox[{"Partition", "[", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"{", "int", "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Infinity]"}], ",", "mid___", ",", "\[Infinity]"}], 
          "}"}], ":>", 
         RowBox[{"{", "mid", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Infinity]"}], ",", "mid__"}], "}"}], ":>", 
         RowBox[{"{", 
          RowBox[{"mid", ",", "\[Infinity]"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mid__", ",", "\[Infinity]"}], "}"}], ":>", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Infinity]"}], ",", "mid"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "mid___", "}"}], ":>", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Infinity]"}], ",", "mid", ",", "\[Infinity]"}], 
          "}"}]}]}], "}"}]}], ",", "2"}], "]"}]}]}]}], "Code",
 CellChangeTimes->{{3.7339965619943337`*^9, 3.7339965913223963`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IntervalComplement", "::", "usage"}], "=", 
   "\"\<IntervalComplement[a_,b_,c_,..] returnes a\[Backslash](b\:222ac\:222a\
\[Ellipsis])\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"IntervalComplement", "[", 
   RowBox[{"a_Interval", ",", "b__Interval"}], "]"}], ":=", 
  RowBox[{"IntervalIntersection", "[", 
   RowBox[{"a", ",", 
    RowBox[{"IntervalInverse", "@", 
     RowBox[{"IntervalUnion", "[", "b", "]"}]}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.733996540845982*^9, 3.7339965487865243`*^9}, {
  3.733996609586728*^9, 3.73399661666479*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting", "Section",
 CellChangeTimes->{{3.7339177915338836`*^9, 3.7339177947598133`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindLogFit", "::", "usage"}], "=", 
   "\"\<FindLogFit[data_, expr_, rest__]. The function is equivalent to \
FindFit, but minimizes error on log Y scale.\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"FindLogFit", "[", 
   RowBox[{"data_", ",", "expr_", ",", "rest__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "logData", "}"}], ",", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "The", " ", "function", " ", "is", " ", "equivalent", " ", "to", " ", 
       "FindFit"}], ",", " ", 
      RowBox[{
      "but", " ", "works", " ", "in", " ", "log", " ", "Y", " ", "scale"}]}], 
     "*)"}], "\n", "\t", 
    RowBox[{
     RowBox[{"logData", "=", 
      RowBox[{"Which", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"VectorQ", "[", "data", "]"}], ",", 
        RowBox[{"Log", "[", 
         RowBox[{"Abs", "[", "data", "]"}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"data", " ", "list"}], "*)"}], "\n", "\t\t", 
        RowBox[{"XYListQ", "[", "data", "]"}], ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], 
         "]"}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{"XY", " ", "data"}], "*)"}], "\n", "\t\t", "True", ",", 
        RowBox[{"{", "}"}]}], "\n", "\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{"FindFit", "[", 
      RowBox[{"logData", ",", 
       RowBox[{"Log", "[", "expr", "]"}], ",", "rest"}], "]"}]}]}], "\n", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.733917815068692*^9, 3.733917821169559*^9}, {
  3.734534456720999*^9, 3.7345344760129175`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FitRangeSelector", "::", "usage"}], "=", 
   "\"\<FitRangeSelector[fitRanges_, traceList_]\n\tCreate an interactive \
plot to select intervals for each element in the traceList_ (presumably for \
future use in fitting)\n\nInteractive operation:\n\tLeft mouse click - set \
lower x interval boundary at current mouse cursor position\n\tRight mouse \
click - set upper x interval boundary at current mouse cursor position\n\t\n\
Output:\n\tThe list of ranges is assigned to fitRanges_\n\nOptions:\n\t\
LogYPlot\[Rule]False\n\tLogXPlot\[Rule]False\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FitRangeSelector", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LogYPlot", "\[Rule]", "False"}], ",", 
     RowBox[{"LogXPlot", "\[Rule]", "False"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FitRangeSelector", ",", "HoldFirst"}], "]"}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "Hold", " ", "attribute", " ", "for", " ", "the", " ", "\"\<fitRanges\>\"",
     " ", "variable", " ", "is", " ", "needed", " ", "for", " ", "being", " ",
     "able", " ", "to", " ", "clear", " ", "the", " ", "variable", " ", "if", 
    " ", "it", " ", "was", " ", "already", " ", "defined"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"FitRangeSelector", "[", 
    RowBox[{"fitRanges_", ",", "traceList_", ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", "FitRangeSelector", "}"}], "]"}]}], "]"}], ":=", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "epList", ",", " ", "LowerLine", ",", "UpperLine", ",", "minList", ",", 
       "maxList", ",", "plotF"}], "}"}], ",", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{"right", " ", "and", " ", "left", " ", "cursor", " ", "lines"}],
       "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"minList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{"tr", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"tr", ",", "traceList"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"maxList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"tr", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"tr", ",", "traceList"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"LowerLine", "[", 
        RowBox[{"i_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"CMYKColor", "[", 
          RowBox[{"1.", ",", "0", ",", "0", ",", ".4"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"2", 
               RowBox[{"minList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"2", 
               RowBox[{"maxList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}], "]"}]}], 
        "}"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"UpperLine", "[", 
        RowBox[{"i_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"CMYKColor", "[", 
          RowBox[{"0.", ",", "0.2", ",", "0.5", ",", ".1"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"2", 
               RowBox[{"minList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"2", 
               RowBox[{"maxList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}], "]"}]}], 
        "}"}]}], ";", "\n", "\t", 
      RowBox[{"plotF", "=", 
       RowBox[{"Which", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "LogYPlot", "]"}], "&&", 
          RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ",", 
         "ListLogLogPlot", ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"OptionValue", "[", "LogYPlot", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ")"}]}], ",", 
         "ListLogPlot", ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"OptionValue", "[", "LogYPlot", "]"}]}], ")"}], "&&", 
          RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ",", 
         "ListLogLinearPlot", ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"OptionValue", "[", "LogYPlot", "]"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ")"}]}], ",", 
         "ListPlot"}], "\n", "\t", "]"}]}], ";", "\n", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "epList", " ", "is", " ", "the", " ", "list", " ", "of", " ", 
        "cursors", " ", "to", " ", "display", " ", "the", " ", "chosen", " ", 
        "boundaries"}], "*)"}], "\n", "\t", 
      RowBox[{"epList", "=", 
       RowBox[{"Table", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"LowerLine", "[", 
            RowBox[{"i", ",", 
             RowBox[{"traceList", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"UpperLine", "[", 
            RowBox[{"i", ",", 
             RowBox[{"traceList", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "]"}]}], 
          "}"}], ",", "\n", "\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}]}], ";",
       "\n", "\t", "\n", "\t", 
      RowBox[{"Clear", "[", "fitRanges", "]"}], ";", "\n", "\t", 
      RowBox[{"fitRanges", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}]}], ";",
       "\n", "\n", "\t", 
      RowBox[{"Manipulate", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"EventHandler", "[", 
         RowBox[{
          RowBox[{"plotF", "[", 
           RowBox[{
            RowBox[{"traceList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"epList", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<MouseClicked\>\"", ",", "1"}], "}"}], ":>", 
            RowBox[{"(", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"fitRanges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"epList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"LowerLine", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"fitRanges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", " ", 
                 RowBox[{"epList", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";"}], 
             "\n", "\t\t\t\t", ")"}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
          "\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<MouseClicked\>\"", ",", "2"}], "}"}], ":>", 
            RowBox[{"(", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"fitRanges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"epList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "=", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"epList", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"UpperLine", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"fitRanges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}]}],
               ";"}], "\n", "\t\t\t\t", ")"}]}], "\n", "\t\t\t", "}"}]}], 
         "\n", "\t\t", "]"}], ",", "\n", "\t\t", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "traceList", "]"}], ",", "1"}], "}"}]}], 
       "\n", "\t", "]"}]}], ",", "\n", 
     RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "]"}]}]}]}], "Code",
 CellChangeTimes->{{3.7339178387628145`*^9, 3.7339178414528418`*^9}, {
  3.7339182639670424`*^9, 3.73391826830243*^9}, {3.733918500368207*^9, 
  3.733918500792617*^9}, {3.7345335624034114`*^9, 3.734533566823221*^9}, {
  3.7345336679254*^9, 3.734533698569162*^9}, {3.7345337407899036`*^9, 
  3.734533746395157*^9}, {3.7345338025229607`*^9, 3.7345338152339487`*^9}, {
  3.734534003755744*^9, 3.7345341891978064`*^9}, {3.7345342202960467`*^9, 
  3.734534352966386*^9}, {3.734534385598068*^9, 3.7345344302903857`*^9}, {
  3.7345345061404667`*^9, 3.7345346192457333`*^9}, {3.734539821170328*^9, 
  3.734539839144967*^9}, {3.734539933051652*^9, 3.7345399382268367`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindFitSeries", "::", "usage"}], "=", 
   "\"\<FindFitSeries[traceList_,fitModel_,pars_,vars_,fitRanges_:Full]\n\t\
Function applies FindFit[] to each element in the list of 2D data traces \
traceList.\n\nInput:\n\tfitModel_, pars_ and vars_ correspond to inputs for \
FindFit[]. fitModel_ and pars_ can be either a single element, \n\tor a list \
of corresponding elements for each trace in traceList.\n\tfitRanges_ is an \
optional argument, if not specified then the entire data set is fitted. \
fitRanges_ can be\n\t1. single range {\!\(\*SubscriptBox[\(x\), \(min\)]\),\!\
\(\*SubscriptBox[\(x\), \(max\)]\)}\n\t2. a list of ranges \
{\!\(\*SubsuperscriptBox[\(x\), \(i\), \(min\)]\),\!\(\*SubsuperscriptBox[\(x\
\), \(i\), \(max\)]\)} for every traceList[[i]]\n\t3. a single Interval\n\t4. \
a list of Interval's for every traceList[[i]]\n\nOutput:\n\tlist of the fit \
replacement rules for each trace in traceList_\n\nOptions: \n\tFitFunction\
\[Rule]FindFit can be either FindFit (by default) of FindLogFit\>\""}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FindFitSeries", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"FitFunction", "\[Rule]", "FindFit"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FindFitSeries", "[", 
    RowBox[{"traceList_", ",", "fitModel_", ",", "pars_", ",", "vars_", ",", 
     RowBox[{"fitRanges", ":", 
      RowBox[{"Except", "[", 
       RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "Full"}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", "FindFitSeries", "}"}], "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dataList", ",", "fitModelsList", ",", "parsList", ",", 
       "frIntervalsList"}], "}"}], ",", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "reduce", " ", "the", " ", "input", " ", "parameters", " ", "from", 
        " ", "all", " ", "the", " ", "various", " ", "acceptable", " ", 
        "forms", " ", "to", " ", "a", " ", "single", " ", "one"}], " ", 
       "\[Dash]", " ", "lists"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"fitRanges", "===", "Full"}], ",", "\n", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
         "if", " ", "the", " ", "entire", " ", "traces", " ", "are", " ", 
          "to", " ", "be", " ", "fitted"}], "*)"}], "\n", "\t\t", 
        RowBox[{"dataList", "=", "traceList"}], ",", "\n", "\t\t", "\n", 
        "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"if", " ", "some", " ", "range", " ", "of", " ", "x"}], "-", 
          RowBox[{
          "values", " ", "is", " ", "to", " ", "be", " ", "selected", " ", 
           "first"}]}], "*)"}], "\n", "\t\t", 
        RowBox[{
         RowBox[{"frIntervalsList", "=", 
          RowBox[{"Which", "[", "\n", "\t\t", 
           RowBox[{"(*", 
            RowBox[{
            "case", " ", "of", " ", "single", " ", "fit", " ", "interval", 
             " ", "for", " ", "all", " ", "the", " ", "traces"}], "*)"}], 
           "\n", "\t\t", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", "fitRanges", "]"}], "===", "Interval"}], 
             ")"}], ",", "\n", "\t\t\t", 
            RowBox[{"Table", "[", 
             RowBox[{"fitRanges", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}], 
            ",", "\n", "\t\t", 
            RowBox[{"(*", 
             RowBox[{
             "case", " ", "of", " ", "individual", " ", "fit", " ", 
              "intervals"}], "*)"}], "\n", "\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "fitRanges", "]"}], "===", "List"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"fitRanges", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "Interval"}], 
              ")"}]}], ",", "\n", "\t\t\t", "fitRanges", ",", "\n", "\t\t", 
            RowBox[{"(*", 
             RowBox[{
             "case", " ", "of", " ", "single", " ", "fit", " ", "range", " ", 
              "for", " ", "all", " ", "the", " ", "traces"}], "*)"}], "\n", 
            "\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "fitRanges", "]"}], "===", "List"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"fitRanges", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", "Interval"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Depth", "[", "fitRanges", "]"}], "==", " ", "2"}], 
              ")"}]}], ",", " ", "\n", "\t\t\t", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Interval", "[", "fitRanges", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}], 
            ",", "\n", "\t\t", 
            RowBox[{"(*", 
             RowBox[{
             "case", " ", "of", " ", "individual", " ", "fit", " ", 
              "ranges"}], "*)"}], "\n", "\t\t", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "fitRanges", "]"}], "===", "List"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"fitRanges", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], 
              ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Depth", "[", "fitRanges", "]"}], "==", " ", "3"}], 
              ")"}]}], ",", " ", "\n", "\t\t\t", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Interval", "[", 
               RowBox[{"fitRanges", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}]}],
            "\n", "\t\t", "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"dataList", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"traceList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"IntervalMemberQ", "[", 
                RowBox[{
                 RowBox[{"frIntervalsList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}]}], 
         ";"}]}], "\n", "\t", "]"}], ";", "\n", "\t", 
      RowBox[{"fitModelsList", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "fitModel", "]"}], "=!=", " ", "List"}], ",", 
         "\n", "\t\t", 
         RowBox[{"Table", "[", 
          RowBox[{"fitModel", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}], ",",
          "\n", "\t\t", "fitModel"}], "\n", "\t", "]"}]}], ";", "\n", "\t", 
      RowBox[{"parsList", "=", 
       RowBox[{"If", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Depth", "[", "pars", "]"}], "<=", "2"}], " ", "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Depth", "[", "pars", "]"}], "==", "3"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"Flatten", "[", "pars", "]"}]}], "]"}], "=!=", " ", 
             RowBox[{"{", "Symbol", "}"}]}]}], ")"}]}], " ", ",", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"pars", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}], ",",
          "\n", "\t\t", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"pars", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}]}], 
        "\n", "\t", "]"}]}], ";", "\n", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{"perform", " ", "fitting"}], "*)"}], "\n", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "FitFunction", "]"}], "[", 
         RowBox[{
          RowBox[{"dataList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"fitModelsList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"parsList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "vars"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}]}]}], 
    "\n", "]"}]}], ";"}], "\n"}], "Code",
 CellChangeTimes->{{3.7339178705336475`*^9, 3.733917913339658*^9}, {
  3.7345373464141545`*^9, 3.7345373513228006`*^9}, {3.7345374935210767`*^9, 
  3.7345375173398075`*^9}, {3.7345376080581307`*^9, 3.7345377423062515`*^9}, {
  3.734539808709217*^9, 3.7345398177540193`*^9}, {3.734539850856926*^9, 
  3.7345399161963816`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FitQualityCheck", "::", "usage"}], "=", 
   "\"\<FitQualityCheck[traceList_,fitRanges_,fitModel_,fitParameters_,fitVar_\
:x]\n\tPlots fits on top of the orifinal data.\n\nInput:\n\tfitModel needs to \
have fitVar as the free variable\n\tfitRanges should be either a single \
fitting interval for all the traces in traceList, or the list of individual \
fitting intervals for traceList[[i]]\n\nOptions:\n\tLogYPlot\[Rule]False,\n\t\
LogXPlot\[Rule]False\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FitQualityCheck", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"LogYPlot", "->", "False"}], ",", 
     RowBox[{"LogXPlot", "->", " ", "False"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FitQualityCheck", "[", 
   RowBox[{
   "traceList_", ",", "fitRanges_", ",", "fitModel_", ",", "fitParameters_", 
    ",", "fitVar_", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"{", "FitQualityCheck", "}"}], "]"}]}], "]"}], ":=", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xPlotRanges", ",", "cPlotF", ",", "dPlotF"}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "fitRanges", "]"}], "=!=", "List"}], ",", " ", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Fit ranges is not a list\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\n", "\t\t", 
     RowBox[{"xPlotRanges", "=", 
      RowBox[{"Which", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Depth", "[", "fitRanges", "]"}], "==", " ", "2"}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{
         "case", " ", "of", " ", "single", " ", "fit", " ", "range", " ", 
          "for", " ", "all", " ", "the", " ", "traces"}], "*)"}], "\n", 
        "\t\t\t", 
        RowBox[{"Table", "[", 
         RowBox[{"fitRanges", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}], ",", 
        "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Depth", "[", "fitRanges", "]"}], "==", " ", "3"}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{
         "case", " ", "of", " ", "individual", " ", "fit", " ", "ranges"}], 
         "*)"}], "\n", "\t\t\t", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"fitRanges", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}]}], 
       "\n", "\t\t", "]"}]}], ";", "\n", "\n", "\t\t", 
     RowBox[{"cPlotF", "=", 
      RowBox[{"Which", "[", " ", 
       RowBox[{"(*", 
        RowBox[{
        "chose", " ", "continuous", " ", "plotting", " ", "function"}], 
        "*)"}], "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "LogYPlot", "]"}], "&&", 
         RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ",", "LogLogPlot", 
        ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"OptionValue", "[", "LogYPlot", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ")"}]}], ",", 
        "LogPlot", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "LogYPlot", "]"}]}], ")"}], "&&", 
         RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ",", 
        "LogLinearPlot", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "LogYPlot", "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ")"}]}], ",", 
        "Plot"}], "\n", "\t\t", "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"dPlotF", "=", 
      RowBox[{"Which", "[", " ", 
       RowBox[{"(*", 
        RowBox[{"chose", " ", "discrete", " ", "plotting", " ", "function"}], 
        "*)"}], "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "LogYPlot", "]"}], "&&", 
         RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ",", 
        "ListLogLogPlot", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"OptionValue", "[", "LogYPlot", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ")"}]}], ",", 
        "ListLogPlot", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "LogYPlot", "]"}]}], ")"}], "&&", 
         RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ",", 
        "ListLogLinearPlot", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "LogYPlot", "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "LogXPlot", "]"}]}], ")"}]}], ",", 
        "ListPlot"}], "\n", "\t\t", "]"}]}], ";", "\n", "\n", "\t\t", 
     RowBox[{"Do", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", "i", "]"}], ";", "\n", "\t\t\t", 
        RowBox[{"Print", "[", "\n", "\t\t\t\t", 
         RowBox[{"Show", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"dPlotF", "[", 
            RowBox[{
             RowBox[{"traceList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xPlotRanges", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "Full"}], "}"}]}]}], 
            "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"cPlotF", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "fitModel", ")"}], "/.", 
              RowBox[{"fitParameters", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"fitVar", ",", 
               RowBox[{"xPlotRanges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"xPlotRanges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"PlotStyle", "->", 
              RowBox[{"Directive", "[", 
               RowBox[{"Red", ",", "Thin"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "\n", "\t\t\t\t",
           "]"}], "\n", "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "traceList", "]"}]}], "}"}]}], "]"}]}]}], 
   "\n", "]"}]}]}], "Code",
 CellChangeTimes->{{3.733917931615965*^9, 3.7339179675239677`*^9}, {
  3.7339180576504264`*^9, 3.733918236197213*^9}, {3.733918727317361*^9, 
  3.733918762591159*^9}, {3.7339188058385124`*^9, 3.7339188440587387`*^9}, {
  3.7345336679514303`*^9, 3.7345336781558027`*^9}, {3.7345337702243547`*^9, 
  3.7345337739129915`*^9}, {3.7345391406094456`*^9, 3.734539150722803*^9}, {
  3.734539216142032*^9, 3.7345392265377836`*^9}, {3.734539314258649*^9, 
  3.734539314833763*^9}, {3.7345393595407877`*^9, 3.7345393763688483`*^9}, {
  3.7345394340843024`*^9, 3.734539454541932*^9}, {3.73453952479661*^9, 
  3.7345395462154975`*^9}, {3.7345395807278595`*^9, 3.734539733632825*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1282, 772},
WindowMargins->{{Automatic, 113}, {Automatic, 3}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 618, 15, 50, "Input",
 CellID->484687852],
Cell[CellGroupData[{
Cell[1201, 39, 116, 1, 70, "Section"],
Cell[1320, 42, 1291, 36, 142, "Code"],
Cell[2614, 80, 620, 16, 87, "Code"],
Cell[3237, 98, 992, 17, 196, "Code"],
Cell[4232, 117, 1492, 36, 141, "Code"],
Cell[5727, 155, 1007, 27, 123, "Code",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6771, 187, 126, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[6922, 192, 121, 1, 49, "Subsection"],
Cell[7046, 195, 626, 16, 69, "Code"],
Cell[7675, 213, 4186, 136, 285, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11898, 354, 124, 1, 49, "Subsection"],
Cell[12025, 357, 12813, 336, 1419, "Code"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24887, 699, 113, 1, 70, "Section"],
Cell[25003, 702, 455, 13, 50, "Code"],
Cell[25461, 717, 1458, 41, 105, "Code"],
Cell[26922, 760, 600, 14, 87, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27559, 779, 96, 1, 70, "Section"],
Cell[27658, 782, 1941, 50, 231, "Code"],
Cell[29602, 834, 10484, 248, 987, "Code"],
Cell[40089, 1084, 9833, 231, 1024, "Code"],
Cell[49925, 1317, 7480, 176, 843, "Code"]
}, Open  ]]
}
]
*)

